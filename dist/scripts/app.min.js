angular.module("hashtuber",["ui.router","ngRoute","pascalprecht.translate","720kb.socialshare","ngSanitize","ngEmbed"]).constant("Config",{apiBase:"/api/search",colors:["#6caff1","#ff5967","#ff794d","#5082e5","#be5fb6","#33ccbe","#ffaf40","#68bf60","#cccc52","#f279ac","#7870cc","#548899"]}).config(function($stateProvider,$urlRouterProvider,$locationProvider,$translateProvider){$stateProvider.state("hashtag",{url:"/search/{hashtag}",templateUrl:"../views/base/_tweets.html",controller:"tweetCtrl",params:{hashtag:{squash:!0}}}).state("home",{url:"/",controller:"homeCtrl",templateUrl:"../views/base/_home.html"}),$urlRouterProvider.otherwise("/"),$locationProvider.html5Mode(!0),$translateProvider.translations("en",{info_two:"Click on <strong>#HashTuber</strong> and change it to your hashtag",two:"Choose your hashtag",info_one:"What are you waiting for? press <strong>Enter</strong> or <strong>Intro</strong>",one:"Easy peasy",info_go:"Start your streaming questions and don't forget share this page, It's <strong>FREE</strong>!!",go:"Start",power:"Powered by orggue ",beer:" Buy me a beer",load:"LOAD MORE",filter_date:"Date",filter_rt:"Retweet",filter_fav:"Favorites",filter_ran:"Random",tool_tip_share:"Share me",tool_tip_working:"Working in progress",share:"#HashTuber a really great tool to play with ",placeholder:"Find a question containing..."}),$translateProvider.translations("es",{info_two:"Click en <strong>#HashTuber</strong> y escribe tu propio hashtag",two:"Elige un hashtag",info_one:"¿A que estás esperando? presiona <strong>Enter</strong> o <strong>Intro</strong>",one:"Demasiado facil",info_go:"Empieza tu streaming respondiendo las preguntas y no olvides compartir hashtuber, es <strong>GRATIS</strong>!!",go:"Empieza",power:"Powered by orggue",beer:"Comprame una cerveza",load:"CARGAR MAS",filter_date:"Fecha",filter_rt:"Retweets",filter_fav:"Favoritos",filter_ran:"Aleatorio",tool_tip_share:"Comparteme",tool_tip_working:"Trabajando en esto",share:"Hazme preguntas, con #HashTuber contesto todas ",placeholder:"Busca una pregunta concreta"}),$translateProvider.preferredLanguage("en"),$translateProvider.useSanitizeValueStrategy("sanitize")}).run(function(randomcolor,$translate){randomcolor.setHeaderColor(randomcolor.getRandomColor());var userLang=navigator.language||navigator.userLanguage;$translate.use(-1!=userLang.indexOf("es")||-1!=userLang.indexOf("sp")?"es":"en")}),angular.module("hashtuber").controller("homeCtrl",function($scope,$element,$translate,randomcolor){$scope.info={two:{title:$translate.instant("two"),text:$translate.instant("info_two")},one:{title:$translate.instant("one"),text:$translate.instant("info_one")},go:{title:$translate.instant("go"),text:$translate.instant("info_go")}},$el=$($element),$info=$el.find("h2"),$info.css("color",randomcolor.getRandomColor())}),angular.module("hashtuber").controller("tweetCtrl",function($scope,$stateParams,$element,$translate,randomcolor,middleware){$scope.color=randomcolor.getHeaderColor(),$scope.load=$translate.instant("load"),$scope.placeholder=$translate.instant("placeholder"),$scope.button={date:$translate.instant("filter_date"),rt:$translate.instant("filter_rt"),fav:$translate.instant("filter_fav"),ran:$translate.instant("filter_ran"),tooltip:$translate.instant("tool_tip_working")},$scope.reverse=!1,$scope.sortType="date",$scope.order=function(type,rev){$scope.reverse=rev,$scope.sortType=type},$scope.tweets=[],$scope.$on("EndSearch",function(error,data){angular.forEach(data.tweets,function(tweet){$scope.tweets.push(tweet)})}),$stateParams.hashtag&&middleware.setFilter("hashtag",$stateParams.hashtag),middleware.search(),$scope.randomQuestion=function(){},$scope.loadMore=function(){middleware.setFilter("since_id",$scope.tweets[$scope.tweets.length-1].id),middleware.loadMore()}}),angular.module("hashtuber").directive("hashheader",function(){return{restrict:"E",replace:!0,templateUrl:"../views/base/hashheader.html",controller:function($scope,middleware,randomcolor,$element,$timeout,$stateParams,$state,$translate){var $el=$($element),$input=$el.find("#title");$input.css("color",randomcolor.getHeaderColor()),$scope.search="#"+middleware.getFilter("hashtag"),$input.on("focus",function(){$scope.$apply(function(){$scope.search="#"})}),$input.blur(function(){$scope.$apply(function(){$scope.search="#"+middleware.getFilter("hashtag")})}),$scope.searchHashtag=function(){$scope.search=$scope.search.replace(/ /g,""),$scope.search=$scope.search.replace(/#/g,""),middleware.getFilter("hashtag")!=$scope.search&&(middleware.setFilter("hashtag",$scope.search),middleware.search()),$timeout(function(){$input.blur()},50)},$scope.$on("NewSearch",function(){$state.go("hashtag",{hashtag:middleware.getFilter("hashtag")}),$scope.search="#"+middleware.getFilter("hashtag")}),$scope.color=randomcolor.getHeaderColor(),$scope.share={socialShare:$translate.instant("share"),ToolTip:$translate.instant("tool_tip_share")},$scope.topLinks={paypal:$translate.instant("beer"),github:$translate.instant("power")}}}}),angular.module("hashtuber").directive("tweet",function(){return{restrict:"E",replace:!0,scope:{tweet:"="},templateUrl:"../views/base/_tweet.html",controller:function($scope,$element){$el=$($element),$a=$el.find("a"),$a.hover(function(){$(this).css("color",$scope.tweet.color)},function(){$(this).css("color","#262626")})}}}),angular.module("hashtuber").filter("linkUsername",function(randomcolor){return function(text){return'<a class="hashtag-link" href="http://twitter.com/'+text.slice(1)+'">'+text+"</a>"}}).filter("linkHashtag",function(){return function(text){return'<a class="hashtag-link" href="http://twitter.com/search/%23'+text.slice(1)+'">'+text+"</a>"}}).filter("tweet",function(){return function(text){var urlRegex=/((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/g,twitterUserRegex=/@([a-zA-Z0-9_]{1,20})/g,twitterHashTagRegex=/\B#(\w+)/g;return text=text.replace(urlRegex," <a class='hashtag-link' href='$&' target='_blank'>$&</a>").trim(),text=text.replace(twitterUserRegex,"<a class='hashtag-link' href='http://www.twitter.com/$1' target='_blank'>@$1</a>"),text=text.replace(twitterHashTagRegex,"<a class='hashtag-link' href='http://twitter.com/search/%23$1' target='_blank'>#$1</a>")}}),angular.module("hashtuber").service("api",function($http,$q,Config){return{call:function(params,data,callback,method){method=method?method:"GET";var canceler=$q.defer();return $http({url:Config.apiBase,method:method,params:params,timeout:canceler.promise,data:data}).success(function(data,status){"function"==typeof callback&&callback(data)}),{cancel:function(){canceler.resolve()}}}}}),angular.module("hashtuber").service("middleware",function($http,api,$rootScope){var backup=[],filters={hashtag:"HashTuber",since_id:0},search=function(filters,callback){var params={hashtag:filters.hashtag,since_id:filters.since_id};return api.call(params,{},function(data){"function"==typeof callback&&callback(data)})};return{search:function(){$rootScope.$broadcast("NewSearch");var question=search(filters,function(data){$rootScope.$broadcast("EndSearch",{tweets:data})});backup.push(question)},loadMore:function(){$rootScope.$broadcast("LoadMore");var question=search(filters,function(data){$rootScope.$broadcast("EndSearch",{tweets:data})});backup.push(question)},setFilter:function(key,value){filters[key]=value},getFilter:function(key){return filters[key]},getAllFilters:function(){return filters},filters:filters}}),angular.module("hashtuber").service("randomcolor",function(Config){var headerColor;return{getRandomColor:function(){var index=Math.floor(Math.random()*Config.colors.length);return Config.colors[index]},setHeaderColor:function(color){headerColor=color},getHeaderColor:function(){return headerColor}}});